/*! angular-spotify 2014-09-01 */
!function(a,b){"use strict";var c={};b.module("spotify",[]).value("settings",c).provider("Spotify",function(){c.clientId=null,c.redirectUri=null,c.scope=null,c.accessToken=null,this.setClientId=function(a){console.log("set clientId"),c.clientId=a},this.getClientId=function(){return c.clientId},this.setRedirectUri=function(a){c.redirectUri=a},this.getRedirectUri=function(){return c.redirectUri},this.setScope=function(a){c.scope=a};var b=function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")};c.version="v1",c.apiBase="https://api.spotify.com/"+c.version,this.$get=function(d,e,f){function g(){this.clientId=c.clientId,this.redirectUri=c.redirectUri,this.apiBase=c.apiBase}return g.prototype.api=function(a,b,c,f,g){var h=d.defer();return e({url:this.apiBase+a,method:b?b:"GET",params:c,data:f,headers:g}).success(function(a){h.resolve(a)}).error(function(a){h.reject(a)}),h.promise},g.prototype.search=function(a,b,c){return c=c||{},c.q=a,c.type=b,this.api("/search","GET",c)},g.prototype.getAlbum=function(a){return a=-1===a.indexOf("spotify:")?a:a.split(":")[2],this.api("/albums/"+a)},g.prototype.getAlbums=function(a){return this.api("/albums","GET",{ids:a})},g.prototype.getAlbumTracks=function(a,b){return a=-1===a.indexOf("spotify:")?a:a.split(":")[2],this.api("/albums/"+a+"/tracks","GET",b)},g.prototype.getArtist=function(a){return a=-1===a.indexOf("spotify:")?a:a.split(":")[2],this.api("/artists/"+a)},g.prototype.getArtists=function(a){return this.api("/artists/","GET",{ids:a.toString()})},g.prototype.getArtistAlbums=function(a,b){return a=-1===a.indexOf("spotify:")?a:a.split(":")[2],this.api("/artists/"+a+"/albums","GET",b)},g.prototype.getArtistTopTracks=function(a,b){return a=-1===a.indexOf("spotify:")?a:a.split(":")[2],this.api("/artists/"+a+"/top-tracks","GET",{country:b})},g.prototype.getRelatedArtists=function(a){return a=-1===a.indexOf("spotify:")?a:a.split(":")[2],this.api("/artists/"+a+"/related-artists")},g.prototype.getTrack=function(a){return a=-1===a.indexOf("spotify:")?a:a.split(":")[2],this.api("/tracks/"+a)},g.prototype.getTracks=function(a){return this.api("/tracks/","GET",{ids:a.toString()})},g.prototype.getUserPlaylists=function(a,b){return this.api("/users/"+a+"/playlists","GET",b,null,{Authorization:"Bearer "+c.authToken})},g.prototype.getPlaylist=function(a,b,d){return this.api("/users/"+a+"/playlists/"+b,"GET",d,null,{Authorization:"Bearer "+c.authToken})},g.prototype.getPlaylistTracks=function(a,b,d){return this.api("/users/"+a+"/playlists/"+b+"/tracks","GET",d,null,{Authorization:"Bearer "+c.authToken})},g.prototype.createPlaylist=function(a,b){return this.api("/users/"+a+"/playlists","POST",null,b,{Authorization:"Bearer "+c.authToken,"Content-Type":"application/json"})},g.prototype.addPlaylistTracks=function(a,b,d){return this.api("/users/"+a+"/playlists/"+b+"/tracks","POST",{uris:d.toString()},null,{Authorization:"Bearer "+c.authToken,"Content-Type":"application/json"})},g.prototype.login=function(){function e(a){m&&m.close(),c.accessToken=a.data,g.resolve(a.data)}var g=d.defer(),h=400,i=500,j=screen.width/2-h/2,k=screen.height/2-i/2,l={client_id:this.clientId,redirect_uri:this.redirectUri,scope:this.scope||"",response_type:"token"},m=a.open("https://accounts.spotify.com/authorize?"+b(l),"Spotify","menubar=no,location=no,resizable=no,scrollbars=no,status=no,width="+h+",height="+i+",top="+k+",left="+j);return f.addEventListener("message",e,!1),g.promise},new g}})}(window,angular);